<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Ensemble Models</title>
    <meta charset="utf-8" />
    <meta name="author" content="Alison Hill" />
    <meta name="date" content="2020-04-23" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="assets/css/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/my-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">











layout: true

&lt;a class="footer-link" href="TBD"&gt;TBD&lt;/a&gt;

---

class: title-slide, center, bottom

# Ensemble Models

## Tidymodels, Virtually: 4

### Alison Hill 


---
name: clouds
class: center, middle
background-image: url(images/Clouds.jpg)
background-size: cover

---
name: clouds2
background-image: url(images/Clouds2.jpg)
background-size: cover

---
template: clouds2
class: middle, center


### Alison Hill 

&lt;img style="border-radius: 50%;" src="https://conf20-intro-ml.netlify.com/authors/alison/avatar.jpg" width="150px"/&gt;

[<i class="fab  fa-github "></i> @apreshill](https://github.com/apreshill)  
[<i class="fab  fa-twitter "></i> @apreshill](https://twitter.com/apreshill)



???

My name is Alison Hill, and I'm a data scientist and professional educator at RStudio.


---
class: middle, center, frame

# Goal of Predictive Modeling

--


## üî® build .display[models] that

--


## üéØ generate .display[accurate predictions]

--


## üîÆ for .display[future, yet-to-be-seen data]



--

.footnote[Max Kuhn &amp; Kjell Johnston, http://www.feat.engineering/]


???

This is our whole game vision for today. This is the main goal for predictive modeling broadly, and for machine learning specifically.

We'll use this goal to drive learning of 3 core tidymodels packages:

- parsnip
- yardstick
- and rsample

---
class: inverse, middle, center

# ü•ñ Bagging models

--

## with baguette


???

Enter the rsample package


---
class: middle, center, frame

# baguette

&lt;iframe src="https://tidymodels.github.io/baguette/" width="100%" height="400px"&gt;&lt;/iframe&gt;

---
class: middle, frame


# .center[To specify a model with parsnip]

.right-column[

1\. Pick a .display[model]

2\. Set the .display[engine]

3\. Set the .display[mode] (if needed)

]

---
class: middle, frame


# .center[To specify a classification tree with parsnip]


```r
decision_tree() %&gt;% 
  set_engine("rpart") %&gt;% 
  set_mode("classification")
```


---
class: your-turn

# Your turn 1

Here is our very-vanilla parsnip model specification for a decision tree (also in your Rmd)...


```r
vanilla_tree_spec &lt;-
  decision_tree() %&gt;% 
  set_engine("rpart") %&gt;% 
  set_mode("classification")
```

---
class: your-turn

# Your turn 1

Fill in the blanks to return the accuracy and ROC AUC for this model using 10-fold cross-validation.

<div class="countdown" id="timer_5ea1c5e7" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">02</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---


```r
set.seed(100)
so_folds &lt;- vfold_cv(so_train)

vanilla_tree_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.639    10  0.0142
&gt; 2 roc_auc  binary     0.652    10  0.0197
```



---
class: middle, center

# `args()`

Print the arguments for a **parsnip** model specification.


```r
args(decision_tree)
```

---
class: middle, center

# `decision_tree()`

Specifies a decision tree model


```r
decision_tree(tree_depth = 30, min_n = 20, cost_complexity = .01)
```

--

*either* mode works!

---
class: middle

.center[

# `decision_tree()`

Specifies a decision tree model

]



```r
decision_tree(
  tree_depth = 30,       # max tree depth
  min_n = 20,            # smallest node allowed
  cost_complexity = .01  # 0 &gt; cp &gt; 0.1
  )
```


---
class: middle, center

# `set_args()`

Change the arguments for a **parsnip** model specification.


```r
_spec %&gt;% set_args(tree_depth = 3)
```

---
class: middle


```r
decision_tree() %&gt;% 
  set_engine("rpart") %&gt;% 
  set_mode("classification") %&gt;% 
* set_args(tree_depth = 3)
&gt; Decision Tree Model Specification (classification)
&gt; 
&gt; Main Arguments:
&gt;   tree_depth = 3
&gt; 
&gt; Computational engine: rpart
```

---
class: middle


```r
*decision_tree(tree_depth = 3) %&gt;%
  set_engine("rpart") %&gt;% 
  set_mode("classification")
&gt; Decision Tree Model Specification (classification)
&gt; 
&gt; Main Arguments:
&gt;   tree_depth = 3
&gt; 
&gt; Computational engine: rpart
```

---
class: middle, center

# `tree_depth`

Cap the maximum tree depth.

A method to stop the tree early. Used to prevent overfitting.


```r
vanilla_tree_spec %&gt;% set_args(tree_depth = 30)
```

---
class: middle, center
exclude: true



---
class: middle, center

&lt;img src="figs/04-ensemble/unnamed-chunk-14-1.png" width="864" style="display: block; margin: auto;" /&gt;

---
class: middle, center

&lt;img src="figs/04-ensemble/unnamed-chunk-15-1.png" width="864" style="display: block; margin: auto;" /&gt;

---
class: middle, center

&lt;img src="figs/04-ensemble/unnamed-chunk-16-1.png" width="864" style="display: block; margin: auto;" /&gt;

---
class: middle, center

# `min_n`

Set minimum `n` to split at any node.

Another early stopping method. Used to prevent overfitting.


```r
vanilla_tree_spec %&gt;% set_args(min_n = 20)
```

---
class: middle, center

# Quiz

What value of `min_n` would lead to the *most overfit* tree?

--

`min_n` = 1

---
class: middle, center, frame

# Recap: early stopping

| `parsnip` arg | `rpart` arg | default | overfit? |
|---------------|-------------|:-------:|:--------:|
| `tree_depth`  | `maxdepth`  |    30   |‚¨ÜÔ∏è|
| `min_n`       | `minsplit`  |    20   |‚¨áÔ∏è|


---
class: middle, center

# `cost_complexity`

Adds a cost or penalty to error rates of more complex trees.

A way to prune a tree. Used to prevent overfitting.


```r
vanilla_tree_spec %&gt;% set_args(cost_complexity = .01)
```

--

Closer to zero ‚û°Ô∏è larger trees. 

Higher penalty ‚û°Ô∏è smaller trees. 

---
class: middle, center

&lt;img src="figs/04-ensemble/unnamed-chunk-19-1.png" width="720" style="display: block; margin: auto;" /&gt;

---
name: bonsai
background-image: url(images/kari-shea-AVqh83jStMA-unsplash.jpg)
background-position: left
background-size: contain
class: middle

---
template: bonsai

.pull-right[

# Consider the bonsai

1. Small pot

1. Strong shears

]

---
template: bonsai

.pull-right[

# Consider the bonsai

1. ~~Small pot~~ .display[Early stopping]

1. ~~Strong shears~~ .display[Pruning]

]

---
class: middle, center, frame

# Recap: early stopping &amp; pruning

| `parsnip` arg | `rpart` arg | default | overfit? |
|---------------|-------------|:-------:|:--------:|
| `tree_depth`  | `maxdepth`  |    30   |‚¨ÜÔ∏è|
| `min_n`       | `minsplit`  |    20   |‚¨áÔ∏è|
| `cost_complexity`  | `cp`  |    .01  |‚¨áÔ∏è|

---
class: middle, center

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; engine &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; parsnip &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; original &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; rpart &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; tree_depth &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; maxdepth &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; rpart &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; min_n &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; minsplit &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; rpart &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; cost_complexity &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; cp &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&lt;https://rdrr.io/cran/rpart/man/rpart.control.html&gt;

---
class: your-turn

# Your turn 2

Create a new classification tree model spec; call it `big_tree_spec`. 
Set the cost complexity to `0`, and the minimum number of data points in a node to split to be `1`. 

Compare the metrics of the big tree to the vanilla tree- which one predicts the test set better?

*Hint: you'll need https://tidymodels.github.io/parsnip/reference/decision_tree.html*

<div class="countdown" id="timer_5ea1c5b0" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

```r
big_tree_spec &lt;- 
* decision_tree(min_n = 1, cost_complexity = 0) %&gt;%
  set_engine("rpart") %&gt;% 
  set_mode("classification")

set.seed(100) # Important!
big_tree_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.565    10  0.0164
&gt; 2 roc_auc  binary     0.572    10  0.0133
```

--

Compare to `vanilla`: accuracy = 0.64; ROC AUC = 0.65


---
exclude: true
class: middle

.center[ 
# Where is the fit?
]

```r
big_tree
## # Monte Carlo cross-validation (0.75/0.25) with 1 resamples  
## # A tibble: 1 x 6
##   splits   id      .metrics   .notes  .predictions .workflow
##   &lt;list&gt;   &lt;chr&gt;   &lt;list&gt;     &lt;list&gt;  &lt;list&gt;       &lt;list&gt;   
## 1 &lt;split ‚Ä¶ train/‚Ä¶ &lt;tibble [‚Ä¶ &lt;tibbl‚Ä¶ &lt;tibble [28‚Ä¶ &lt;workflo‚Ä¶
```


---
exclude: true
class: middle

.center[ 
# Where is the fit?
]




```r
get_tree_fit(big_tree)
&gt; parsnip model object
&gt; 
&gt; Fit time:  55ms 
&gt; n= 864 
&gt; 
&gt; node), split, n, loss, yval, (yprob)
&gt;       * denotes terminal node
&gt; 
&gt;       1) root 864 432 Remote (0.50000000 0.50000000)  
&gt;         2) salary&gt;=89196.97 329 103 Remote (0.68693009 0.31306991)  
&gt;           4) company_size_number&lt; 15 54   5 Remote (0.90740741 0.09259259)  
&gt;             8) company_size_number&lt; 5.5 27   0 Remote (1.00000000 0.00000000) *
&gt;             9) company_size_number&gt;=5.5 27   5 Remote (0.81481481 0.18518519)  
&gt;              18) web_developer&gt;=0.5 24   3 Remote (0.87500000 0.12500000)  
&gt;                36) desktop_applications_developer&lt; 0.5 22   2 Remote (0.90909091 0.09090909)  
&gt;                  72) career_satisfaction&lt; 8.5 10   0 Remote (1.00000000 0.00000000) *
&gt;                  73) career_satisfaction&gt;=8.5 12   2 Remote (0.83333333 0.16666667)  
&gt;                   146) career_satisfaction&gt;=9.5 8   0 Remote (1.00000000 0.00000000) *
&gt;                   147) career_satisfaction&lt; 9.5 4   2 Remote (0.50000000 0.50000000)  
&gt;                     294) salary&lt; 97500 1   0 Remote (1.00000000 0.00000000) *
&gt;                     295) salary&gt;=97500 3   1 Not remote (0.33333333 0.66666667)  
&gt;                       590) mobile_developer&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                       591) mobile_developer&lt; 0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                37) desktop_applications_developer&gt;=0.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                  74) salary&lt; 121000 1   0 Remote (1.00000000 0.00000000) *
&gt;                  75) salary&gt;=121000 1   0 Not remote (0.00000000 1.00000000) *
&gt;              19) web_developer&lt; 0.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                38) open_source&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                39) open_source&lt; 0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;           5) company_size_number&gt;=15 275  98 Remote (0.64363636 0.35636364)  
&gt;            10) years_coded_job&gt;=7.5 196  58 Remote (0.70408163 0.29591837)  
&gt;              20) open_source&gt;=0.5 85  17 Remote (0.80000000 0.20000000)  
&gt;                40) salary&gt;=93750 79  13 Remote (0.83544304 0.16455696)  
&gt;                  80) graphics_programming&lt; 0.5 76  11 Remote (0.85526316 0.14473684)  
&gt;                   160) machine_learning_specialist&lt; 0.5 73   9 Remote (0.87671233 0.12328767)  
&gt;                     320) company_size_number&gt;=750 26   1 Remote (0.96153846 0.03846154)  
&gt;                       640) salary&gt;=113500 21   0 Remote (1.00000000 0.00000000) *
&gt;                       641) salary&lt; 113500 5   1 Remote (0.80000000 0.20000000)  
&gt;                        1282) years_coded_job&gt;=11.5 4   0 Remote (1.00000000 0.00000000) *
&gt;                        1283) years_coded_job&lt; 11.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                     321) company_size_number&lt; 750 47   8 Remote (0.82978723 0.17021277)  
&gt;                       642) years_coded_job&lt; 14.5 26   2 Remote (0.92307692 0.07692308)  
&gt;                        1284) career_satisfaction&lt; 9.5 19   0 Remote (1.00000000 0.00000000) *
&gt;                        1285) career_satisfaction&gt;=9.5 7   2 Remote (0.71428571 0.28571429)  
&gt;                          2570) salary&gt;=130500 4   0 Remote (1.00000000 0.00000000) *
&gt;                          2571) salary&lt; 130500 3   1 Not remote (0.33333333 0.66666667)  
&gt;                            5142) salary&lt; 115000 1   0 Remote (1.00000000 0.00000000) *
&gt;                            5143) salary&gt;=115000 2   0 Not remote (0.00000000 1.00000000) *
&gt;                       643) years_coded_job&gt;=14.5 21   6 Remote (0.71428571 0.28571429)  
&gt;                        1286) career_satisfaction&gt;=7.5 17   3 Remote (0.82352941 0.17647059)  
&gt;                          2572) hobby&gt;=0.5 13   0 Remote (1.00000000 0.00000000) *
&gt;                          2573) hobby&lt; 0.5 4   1 Not remote (0.25000000 0.75000000)  
&gt;                            5146) years_coded_job&lt; 17.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                            5147) years_coded_job&gt;=17.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                        1287) career_satisfaction&lt; 7.5 4   1 Not remote (0.25000000 0.75000000)  
&gt;                          2574) hobby&lt; 0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                          2575) hobby&gt;=0.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                   161) machine_learning_specialist&gt;=0.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                     322) years_coded_job&lt; 13 1   0 Remote (1.00000000 0.00000000) *
&gt;                     323) years_coded_job&gt;=13 2   0 Not remote (0.00000000 1.00000000) *
&gt;                  81) graphics_programming&gt;=0.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                   162) salary&lt; 131500 1   0 Remote (1.00000000 0.00000000) *
&gt;                   163) salary&gt;=131500 2   0 Not remote (0.00000000 1.00000000) *
&gt;                41) salary&lt; 93750 6   2 Not remote (0.33333333 0.66666667)  
&gt;                  82) mobile_developer&gt;=0.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                  83) mobile_developer&lt; 0.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;              21) open_source&lt; 0.5 111  41 Remote (0.63063063 0.36936937)  
&gt;                42) salary&lt; 115870.5 49  12 Remote (0.75510204 0.24489796)  
&gt;                  84) salary&gt;=109360 19   1 Remote (0.94736842 0.05263158)  
&gt;                   168) company_size_number&gt;=60 15   0 Remote (1.00000000 0.00000000) *
&gt;                   169) company_size_number&lt; 60 4   1 Remote (0.75000000 0.25000000)  
&gt;                     338) career_satisfaction&lt; 8.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                     339) career_satisfaction&gt;=8.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                  85) salary&lt; 109360 30  11 Remote (0.63333333 0.36666667)  
&gt;                   170) graphics_programming&lt; 0.5 28   9 Remote (0.67857143 0.32142857)  
&gt;                     340) hobby&lt; 0.5 11   1 Remote (0.90909091 0.09090909)  
&gt;                       680) years_coded_job&gt;=9.5 10   0 Remote (1.00000000 0.00000000) *
&gt;                       681) years_coded_job&lt; 9.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                     341) hobby&gt;=0.5 17   8 Remote (0.52941176 0.47058824)  
&gt;                       682) salary&gt;=93500 15   6 Remote (0.60000000 0.40000000)  
&gt;                        1364) years_coded_job&gt;=8.5 14   5 Remote (0.64285714 0.35714286)  
&gt;                          2728) career_satisfaction&lt; 7.5 4   0 Remote (1.00000000 0.00000000) *
&gt;                          2729) career_satisfaction&gt;=7.5 10   5 Remote (0.50000000 0.50000000)  
&gt;                            5458) career_satisfaction&gt;=9.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                            5459) career_satisfaction&lt; 9.5 8   3 Not remote (0.37500000 0.62500000)  
&gt;                             10918) company_size_number&lt; 60 1   0 Remote (1.00000000 0.00000000) *
&gt;                             10919) company_size_number&gt;=60 7   2 Not remote (0.28571429 0.71428571)  
&gt;                               21838) embedded_developer&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                               21839) embedded_developer&lt; 0.5 6   1 Not remote (0.16666667 0.83333333)  
&gt;                                 43678) company_size_number&gt;=7500 2   1 Remote (0.50000000 0.50000000)  
&gt;                                   87356) salary&gt;=101000 1   0 Remote (1.00000000 0.00000000) *
&gt;                                   87357) salary&lt; 101000 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                 43679) company_size_number&lt; 7500 4   0 Not remote (0.00000000 1.00000000) *
&gt;                        1365) years_coded_job&lt; 8.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       683) salary&lt; 93500 2   0 Not remote (0.00000000 1.00000000) *
&gt;                   171) graphics_programming&gt;=0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                43) salary&gt;=115870.5 62  29 Remote (0.53225806 0.46774194)  
&gt;                  86) developer_with_stats_math_background&lt; 0.5 57  24 Remote (0.57894737 0.42105263)  
&gt;                   172) systems_administrator&gt;=0.5 5   0 Remote (1.00000000 0.00000000) *
&gt;                   173) systems_administrator&lt; 0.5 52  24 Remote (0.53846154 0.46153846)  
&gt;                     346) web_developer&lt; 0.5 19   5 Remote (0.73684211 0.26315789)  
&gt;                       692) company_size_number&lt; 5250 10   0 Remote (1.00000000 0.00000000) *
&gt;                       693) company_size_number&gt;=5250 9   4 Not remote (0.44444444 0.55555556)  
&gt;                        1386) salary&gt;=131502 6   2 Remote (0.66666667 0.33333333)  
&gt;                          2772) salary&lt; 165000 3   0 Remote (1.00000000 0.00000000) *
&gt;                          2773) salary&gt;=165000 3   1 Not remote (0.33333333 0.66666667)  
&gt;                            5546) salary&gt;=175000 1   0 Remote (1.00000000 0.00000000) *
&gt;                            5547) salary&lt; 175000 2   0 Not remote (0.00000000 1.00000000) *
&gt;                        1387) salary&lt; 131502 3   0 Not remote (0.00000000 1.00000000) *
&gt;                     347) web_developer&gt;=0.5 33  14 Not remote (0.42424242 0.57575758)  
&gt;                       694) career_satisfaction&gt;=9.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                       695) career_satisfaction&lt; 9.5 31  12 Not remote (0.38709677 0.61290323)  
&gt;                        1390) company_size_number&gt;=7500 8   3 Remote (0.62500000 0.37500000)  
&gt;                          2780) career_satisfaction&lt; 7.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                          2781) career_satisfaction&gt;=7.5 5   2 Not remote (0.40000000 0.60000000)  
&gt;                            5562) mobile_developer&lt; 0.5 3   1 Remote (0.66666667 0.33333333)  
&gt;                             11124) salary&gt;=121500 2   0 Remote (1.00000000 0.00000000) *
&gt;                             11125) salary&lt; 121500 1   0 Not remote (0.00000000 1.00000000) *
&gt;                            5563) mobile_developer&gt;=0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                        1391) company_size_number&lt; 7500 23   7 Not remote (0.30434783 0.69565217)  
&gt;                          2782) salary&gt;=128340 18   7 Not remote (0.38888889 0.61111111)  
&gt;                            5564) career_satisfaction&gt;=5 16   7 Not remote (0.43750000 0.56250000)  
&gt;                             11128) company_size_number&gt;=550 4   1 Remote (0.75000000 0.25000000)  
&gt;                               22256) years_coded_job&gt;=14.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                               22257) years_coded_job&lt; 14.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                             11129) company_size_number&lt; 550 12   4 Not remote (0.33333333 0.66666667)  
&gt;                               22258) salary&lt; 157500 8   4 Remote (0.50000000 0.50000000)  
&gt;                                 44516) years_coded_job&lt; 16 2   0 Remote (1.00000000 0.00000000) *
&gt;                                 44517) years_coded_job&gt;=16 6   2 Not remote (0.33333333 0.66666667)  
&gt;                                   89034) salary&gt;=151500 1   0 Remote (1.00000000 0.00000000) *
&gt;                                   89035) salary&lt; 151500 5   1 Not remote (0.20000000 0.80000000)  
&gt;                                    178070) career_satisfaction&lt; 6.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                                    178071) career_satisfaction&gt;=6.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                               22259) salary&gt;=157500 4   0 Not remote (0.00000000 1.00000000) *
&gt;                            5565) career_satisfaction&lt; 5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                          2783) salary&lt; 128340 5   0 Not remote (0.00000000 1.00000000) *
&gt;                  87) developer_with_stats_math_background&gt;=0.5 5   0 Not remote (0.00000000 1.00000000) *
&gt;            11) years_coded_job&lt; 7.5 79  39 Not remote (0.49367089 0.50632911)  
&gt;              22) salary&lt; 114250 51  22 Remote (0.56862745 0.43137255)  
&gt;                44) embedded_developer&lt; 0.5 47  19 Remote (0.59574468 0.40425532)  
&gt;                  88) salary&lt; 90954.55 7   1 Remote (0.85714286 0.14285714)  
&gt;                   176) years_coded_job&gt;=1 6   0 Remote (1.00000000 0.00000000) *
&gt;                   177) years_coded_job&lt; 1 1   0 Not remote (0.00000000 1.00000000) *
&gt;                  89) salary&gt;=90954.55 40  18 Remote (0.55000000 0.45000000)  
&gt;                   178) hobby&gt;=0.5 33  13 Remote (0.60606061 0.39393939)  
&gt;                     356) salary&gt;=91250 32  12 Remote (0.62500000 0.37500000)  
&gt;                       712) salary&lt; 99150 7   1 Remote (0.85714286 0.14285714)  
&gt;                        1424) data_scientist&lt; 0.5 6   0 Remote (1.00000000 0.00000000) *
&gt;                        1425) data_scientist&gt;=0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       713) salary&gt;=99150 25  11 Remote (0.56000000 0.44000000)  
&gt;                        1426) salary&gt;=101000 22   8 Remote (0.63636364 0.36363636)  
&gt;                          2852) salary&lt; 102750 3   0 Remote (1.00000000 0.00000000) *
&gt;                          2853) salary&gt;=102750 19   8 Remote (0.57894737 0.42105263)  
&gt;                            5706) salary&gt;=112250 2   0 Remote (1.00000000 0.00000000) *
&gt;                            5707) salary&lt; 112250 17   8 Remote (0.52941176 0.47058824)  
&gt;                             11414) salary&lt; 110500 15   6 Remote (0.60000000 0.40000000)  
&gt;                               22828) company_size_number&gt;=5500 3   0 Remote (1.00000000 0.00000000) *
&gt;                               22829) company_size_number&lt; 5500 12   6 Remote (0.50000000 0.50000000)  
&gt;                                 45658) career_satisfaction&lt; 6.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                                 45659) career_satisfaction&gt;=6.5 10   4 Not remote (0.40000000 0.60000000)  
&gt;                                   91318) web_developer&gt;=0.5 7   3 Remote (0.57142857 0.42857143)  
&gt;                                    182636) salary&gt;=103500 6   2 Remote (0.66666667 0.33333333)  
&gt;                                      365272) salary&lt; 107500 3   0 Remote (1.00000000 0.00000000) *
&gt;                                      365273) salary&gt;=107500 3   1 Not remote (0.33333333 0.66666667)  
&gt;                                        730546) career_satisfaction&gt;=8.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                                        730547) career_satisfaction&lt; 8.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                                    182637) salary&lt; 103500 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                   91319) web_developer&lt; 0.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                             11415) salary&gt;=110500 2   0 Not remote (0.00000000 1.00000000) *
&gt;                        1427) salary&lt; 101000 3   0 Not remote (0.00000000 1.00000000) *
&gt;                     357) salary&lt; 91250 1   0 Not remote (0.00000000 1.00000000) *
&gt;                   179) hobby&lt; 0.5 7   2 Not remote (0.28571429 0.71428571)  
&gt;                     358) salary&gt;=98500 3   1 Remote (0.66666667 0.33333333)  
&gt;                       716) company_size_number&gt;=300 2   0 Remote (1.00000000 0.00000000) *
&gt;                       717) company_size_number&lt; 300 1   0 Not remote (0.00000000 1.00000000) *
&gt;                     359) salary&lt; 98500 4   0 Not remote (0.00000000 1.00000000) *
&gt;                45) embedded_developer&gt;=0.5 4   1 Not remote (0.25000000 0.75000000)  
&gt;                  90) years_coded_job&gt;=6 1   0 Remote (1.00000000 0.00000000) *
&gt;                  91) years_coded_job&lt; 6 3   0 Not remote (0.00000000 1.00000000) *
&gt;              23) salary&gt;=114250 28  10 Not remote (0.35714286 0.64285714)  
&gt;                46) salary&gt;=151500 2   0 Remote (1.00000000 0.00000000) *
&gt;                47) salary&lt; 151500 26   8 Not remote (0.30769231 0.69230769)  
&gt;                  94) web_developer&gt;=0.5 20   8 Not remote (0.40000000 0.60000000)  
&gt;                   188) company_size_number&lt; 550 6   2 Remote (0.66666667 0.33333333)  
&gt;                     376) years_coded_job&gt;=4.5 5   1 Remote (0.80000000 0.20000000)  
&gt;                       752) years_coded_job&lt; 6.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                       753) years_coded_job&gt;=6.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                        1506) salary&lt; 122500 1   0 Remote (1.00000000 0.00000000) *
&gt;                        1507) salary&gt;=122500 1   0 Not remote (0.00000000 1.00000000) *
&gt;                     377) years_coded_job&lt; 4.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                   189) company_size_number&gt;=550 14   4 Not remote (0.28571429 0.71428571)  
&gt;                     378) database_administrator&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                     379) database_administrator&lt; 0.5 13   3 Not remote (0.23076923 0.76923077)  
&gt;                       758) graphic_designer&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                       759) graphic_designer&lt; 0.5 12   2 Not remote (0.16666667 0.83333333)  
&gt;                        1518) career_satisfaction&lt; 6.5 4   2 Remote (0.50000000 0.50000000)  
&gt;                          3036) salary&gt;=125000 1   0 Remote (1.00000000 0.00000000) *
&gt;                          3037) salary&lt; 125000 3   1 Not remote (0.33333333 0.66666667)  
&gt;                            6074) hobby&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                            6075) hobby&lt; 0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                        1519) career_satisfaction&gt;=6.5 8   0 Not remote (0.00000000 1.00000000) *
&gt;                  95) web_developer&lt; 0.5 6   0 Not remote (0.00000000 1.00000000) *
&gt;         3) salary&lt; 89196.97 535 206 Not remote (0.38504673 0.61495327)  
&gt;           6) company_size_number&lt; 15 135  59 Remote (0.56296296 0.43703704)  
&gt;            12) years_coded_job&gt;=16.5 15   1 Remote (0.93333333 0.06666667)  
&gt;              24) quality_assurance_engineer&lt; 0.5 14   0 Remote (1.00000000 0.00000000) *
&gt;              25) quality_assurance_engineer&gt;=0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;            13) years_coded_job&lt; 16.5 120  58 Remote (0.51666667 0.48333333)  
&gt;              26) graphic_designer&gt;=0.5 6   0 Remote (1.00000000 0.00000000) *
&gt;              27) graphic_designer&lt; 0.5 114  56 Not remote (0.49122807 0.50877193)  
&gt;                54) salary&lt; 6211.884 14   4 Remote (0.71428571 0.28571429)  
&gt;                 108) salary&gt;=4184.408 7   0 Remote (1.00000000 0.00000000) *
&gt;                 109) salary&lt; 4184.408 7   3 Not remote (0.42857143 0.57142857)  
&gt;                   218) salary&lt; 2202.32 4   1 Remote (0.75000000 0.25000000)  
&gt;                     436) database_administrator&lt; 0.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                     437) database_administrator&gt;=0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                   219) salary&gt;=2202.32 3   0 Not remote (0.00000000 1.00000000) *
&gt;                55) salary&gt;=6211.884 100  46 Not remote (0.46000000 0.54000000)  
&gt;                 110) years_coded_job&gt;=1.5 82  41 Remote (0.50000000 0.50000000)  
&gt;                   220) mobile_developer&lt; 0.5 63  28 Remote (0.55555556 0.44444444)  
&gt;                     440) developer_with_stats_math_background&lt; 0.5 56  22 Remote (0.60714286 0.39285714)  
&gt;                       880) career_satisfaction&gt;=9.5 10   1 Remote (0.90000000 0.10000000)  
&gt;                        1760) systems_administrator&lt; 0.5 7   0 Remote (1.00000000 0.00000000) *
&gt;                        1761) systems_administrator&gt;=0.5 3   1 Remote (0.66666667 0.33333333)  
&gt;                          3522) years_coded_job&gt;=2.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                          3523) years_coded_job&lt; 2.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       881) career_satisfaction&lt; 9.5 46  21 Remote (0.54347826 0.45652174)  
&gt;                        1762) career_satisfaction&lt; 5.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                        1763) career_satisfaction&gt;=5.5 43  21 Remote (0.51162791 0.48837209)  
&gt;                          3526) systems_administrator&gt;=0.5 9   2 Remote (0.77777778 0.22222222)  
&gt;                            7052) years_coded_job&gt;=3.5 7   0 Remote (1.00000000 0.00000000) *
&gt;                            7053) years_coded_job&lt; 3.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                          3527) systems_administrator&lt; 0.5 34  15 Not remote (0.44117647 0.55882353)  
&gt;                            7054) database_administrator&lt; 0.5 29  14 Remote (0.51724138 0.48275862)  
&gt;                             14108) salary&gt;=25879.5 27  12 Remote (0.55555556 0.44444444)  
&gt;                               28216) salary&lt; 36939.39 3   0 Remote (1.00000000 0.00000000) *
&gt;                               28217) salary&gt;=36939.39 24  12 Remote (0.50000000 0.50000000)  
&gt;                                 56434) hobby&gt;=0.5 21   9 Remote (0.57142857 0.42857143)  
&gt;                                  112868) years_coded_job&gt;=2.5 19   7 Remote (0.63157895 0.36842105)  
&gt;                                    225736) embedded_developer&lt; 0.5 17   5 Remote (0.70588235 0.29411765)  
&gt;                                      451472) web_developer&gt;=0.5 16   4 Remote (0.75000000 0.25000000)  
&gt;                                        902944) career_satisfaction&gt;=6.5 13   2 Remote (0.84615385 0.15384615)  
&gt;                                         1805888) company_size_number&gt;=5.5 7   0 Remote (1.00000000 0.00000000) *
&gt;                                         1805889) company_size_number&lt; 5.5 6   2 Remote (0.66666667 0.33333333)  
&gt;                                           3611778) salary&gt;=62812.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                                           3611779) salary&lt; 62812.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                                             7223558) dev_ops&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                                             7223559) dev_ops&lt; 0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                                        902945) career_satisfaction&lt; 6.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                                         1805890) salary&lt; 51693.55 1   0 Remote (1.00000000 0.00000000) *
&gt;                                         1805891) salary&gt;=51693.55 2   0 Not remote (0.00000000 1.00000000) *
&gt;                                      451473) web_developer&lt; 0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                    225737) embedded_developer&gt;=0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                                  112869) years_coded_job&lt; 2.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                                 56435) hobby&lt; 0.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                             14109) salary&lt; 25879.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                            7055) database_administrator&gt;=0.5 5   0 Not remote (0.00000000 1.00000000) *
&gt;                     441) developer_with_stats_math_background&gt;=0.5 7   1 Not remote (0.14285714 0.85714286)  
&gt;                       882) web_developer&lt; 0.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                        1764) salary&gt;=53806.45 1   0 Remote (1.00000000 0.00000000) *
&gt;                        1765) salary&lt; 53806.45 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       883) web_developer&gt;=0.5 5   0 Not remote (0.00000000 1.00000000) *
&gt;                   221) mobile_developer&gt;=0.5 19   6 Not remote (0.31578947 0.68421053)  
&gt;                     442) salary&gt;=65500 2   0 Remote (1.00000000 0.00000000) *
&gt;                     443) salary&lt; 65500 17   4 Not remote (0.23529412 0.76470588)  
&gt;                       886) salary&lt; 43977.27 9   4 Not remote (0.44444444 0.55555556)  
&gt;                        1772) company_size_number&lt; 5.5 6   2 Remote (0.66666667 0.33333333)  
&gt;                          3544) years_coded_job&gt;=5.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                          3545) years_coded_job&lt; 5.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                            7090) salary&lt; 16819.58 1   0 Remote (1.00000000 0.00000000) *
&gt;                            7091) salary&gt;=16819.58 2   0 Not remote (0.00000000 1.00000000) *
&gt;                        1773) company_size_number&gt;=5.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                       887) salary&gt;=43977.27 8   0 Not remote (0.00000000 1.00000000) *
&gt;                 111) years_coded_job&lt; 1.5 18   5 Not remote (0.27777778 0.72222222)  
&gt;                   222) open_source&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                   223) open_source&lt; 0.5 17   4 Not remote (0.23529412 0.76470588)  
&gt;                     446) developer_with_stats_math_background&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                     447) developer_with_stats_math_background&lt; 0.5 16   3 Not remote (0.18750000 0.81250000)  
&gt;                       894) career_satisfaction&lt; 8.5 10   3 Not remote (0.30000000 0.70000000)  
&gt;                        1788) web_developer&lt; 0.5 3   1 Remote (0.66666667 0.33333333)  
&gt;                          3576) salary&lt; 45500 2   0 Remote (1.00000000 0.00000000) *
&gt;                          3577) salary&gt;=45500 1   0 Not remote (0.00000000 1.00000000) *
&gt;                        1789) web_developer&gt;=0.5 7   1 Not remote (0.14285714 0.85714286)  
&gt;                          3578) salary&gt;=68500 1   0 Remote (1.00000000 0.00000000) *
&gt;                          3579) salary&lt; 68500 6   0 Not remote (0.00000000 1.00000000) *
&gt;                       895) career_satisfaction&gt;=8.5 6   0 Not remote (0.00000000 1.00000000) *
&gt;           7) company_size_number&gt;=15 400 130 Not remote (0.32500000 0.67500000)  
&gt;            14) open_source&gt;=0.5 130  54 Not remote (0.41538462 0.58461538)  
&gt;              28) developer_with_stats_math_background&lt; 0.5 120  53 Not remote (0.44166667 0.55833333)  
&gt;                56) salary&lt; 3482.286 3   0 Remote (1.00000000 0.00000000) *
&gt;                57) salary&gt;=3482.286 117  50 Not remote (0.42735043 0.57264957)  
&gt;                 114) embedded_developer&lt; 0.5 113  50 Not remote (0.44247788 0.55752212)  
&gt;                   228) web_developer&lt; 0.5 19   7 Remote (0.63157895 0.36842105)  
&gt;                     456) salary&gt;=69257.09 5   0 Remote (1.00000000 0.00000000) *
&gt;                     457) salary&lt; 69257.09 14   7 Remote (0.50000000 0.50000000)  
&gt;                       914) company_size_number&gt;=550 9   3 Remote (0.66666667 0.33333333)  
&gt;                        1828) salary&gt;=24225.52 8   2 Remote (0.75000000 0.25000000)  
&gt;                          3656) years_coded_job&lt; 12.5 7   1 Remote (0.85714286 0.14285714)  
&gt;                            7312) data_scientist&lt; 0.5 5   0 Remote (1.00000000 0.00000000) *
&gt;                            7313) data_scientist&gt;=0.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                             14626) salary&lt; 42335.7 1   0 Remote (1.00000000 0.00000000) *
&gt;                             14627) salary&gt;=42335.7 1   0 Not remote (0.00000000 1.00000000) *
&gt;                          3657) years_coded_job&gt;=12.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                        1829) salary&lt; 24225.52 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       915) company_size_number&lt; 550 5   1 Not remote (0.20000000 0.80000000)  
&gt;                        1830) salary&lt; 35654.64 2   1 Remote (0.50000000 0.50000000)  
&gt;                          3660) salary&gt;=7271.167 1   0 Remote (1.00000000 0.00000000) *
&gt;                          3661) salary&lt; 7271.167 1   0 Not remote (0.00000000 1.00000000) *
&gt;                        1831) salary&gt;=35654.64 3   0 Not remote (0.00000000 1.00000000) *
&gt;                   229) web_developer&gt;=0.5 94  38 Not remote (0.40425532 0.59574468)  
&gt;                     458) salary&gt;=86760.75 2   0 Remote (1.00000000 0.00000000) *
&gt;                     459) salary&lt; 86760.75 92  36 Not remote (0.39130435 0.60869565)  
&gt;                       918) salary&lt; 80322.58 83  35 Not remote (0.42168675 0.57831325)  
&gt;                        1836) salary&gt;=62951.61 20   8 Remote (0.60000000 0.40000000)  
&gt;                          3672) years_coded_job&lt; 6.5 12   3 Remote (0.75000000 0.25000000)  
&gt;                            7344) data_scientist&lt; 0.5 11   2 Remote (0.81818182 0.18181818)  
&gt;                             14688) years_coded_job&gt;=3.5 5   0 Remote (1.00000000 0.00000000) *
&gt;                             14689) years_coded_job&lt; 3.5 6   2 Remote (0.66666667 0.33333333)  
&gt;                               29378) salary&lt; 75000 5   1 Remote (0.80000000 0.20000000)  
&gt;                                 58756) desktop_applications_developer&lt; 0.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                                 58757) desktop_applications_developer&gt;=0.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                                  117514) salary&lt; 64000 1   0 Remote (1.00000000 0.00000000) *
&gt;                                  117515) salary&gt;=64000 1   0 Not remote (0.00000000 1.00000000) *
&gt;                               29379) salary&gt;=75000 1   0 Not remote (0.00000000 1.00000000) *
&gt;                            7345) data_scientist&gt;=0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                          3673) years_coded_job&gt;=6.5 8   3 Not remote (0.37500000 0.62500000)  
&gt;                            7346) salary&gt;=73742.42 2   0 Remote (1.00000000 0.00000000) *
&gt;                            7347) salary&lt; 73742.42 6   1 Not remote (0.16666667 0.83333333)  
&gt;                             14694) years_coded_job&gt;=10.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                               29388) salary&gt;=71609.85 1   0 Remote (1.00000000 0.00000000) *
&gt;                               29389) salary&lt; 71609.85 1   0 Not remote (0.00000000 1.00000000) *
&gt;                             14695) years_coded_job&lt; 10.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                        1837) salary&lt; 62951.61 63  23 Not remote (0.36507937 0.63492063)  
&gt;                          3674) salary&lt; 41612.12 36  17 Not remote (0.47222222 0.52777778)  
&gt;                            7348) systems_administrator&lt; 0.5 32  15 Remote (0.53125000 0.46875000)  
&gt;                             14696) company_size_number&gt;=60 17   6 Remote (0.64705882 0.35294118)  
&gt;                               29392) company_size_number&lt; 3000 11   2 Remote (0.81818182 0.18181818)  
&gt;                                 58784) years_coded_job&lt; 5.5 9   1 Remote (0.88888889 0.11111111)  
&gt;                                  117568) hobby&gt;=0.5 7   0 Remote (1.00000000 0.00000000) *
&gt;                                  117569) hobby&lt; 0.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                                    235138) salary&gt;=7884.305 1   0 Remote (1.00000000 0.00000000) *
&gt;                                    235139) salary&lt; 7884.305 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                 58785) years_coded_job&gt;=5.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                                  117570) salary&gt;=22446.61 1   0 Remote (1.00000000 0.00000000) *
&gt;                                  117571) salary&lt; 22446.61 1   0 Not remote (0.00000000 1.00000000) *
&gt;                               29393) company_size_number&gt;=3000 6   2 Not remote (0.33333333 0.66666667)  
&gt;                                 58786) career_satisfaction&gt;=5 3   1 Remote (0.66666667 0.33333333)  
&gt;                                  117572) salary&lt; 25356.96 2   0 Remote (1.00000000 0.00000000) *
&gt;                                  117573) salary&gt;=25356.96 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                 58787) career_satisfaction&lt; 5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                             14697) company_size_number&lt; 60 15   6 Not remote (0.40000000 0.60000000)  
&gt;                               29394) desktop_applications_developer&lt; 0.5 12   6 Remote (0.50000000 0.50000000)  
&gt;                                 58788) years_coded_job&lt; 2.5 4   1 Remote (0.75000000 0.25000000)  
&gt;                                  117576) salary&gt;=3964.176 3   0 Remote (1.00000000 0.00000000) *
&gt;                                  117577) salary&lt; 3964.176 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                 58789) years_coded_job&gt;=2.5 8   3 Not remote (0.37500000 0.62500000)  
&gt;                                  117578) years_coded_job&gt;=4.5 4   1 Remote (0.75000000 0.25000000)  
&gt;                                    235156) salary&lt; 40075.76 3   0 Remote (1.00000000 0.00000000) *
&gt;                                    235157) salary&gt;=40075.76 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                  117579) years_coded_job&lt; 4.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                               29395) desktop_applications_developer&gt;=0.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                            7349) systems_administrator&gt;=0.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                          3675) salary&gt;=41612.12 27   6 Not remote (0.22222222 0.77777778)  
&gt;                            7350) salary&gt;=47943.55 18   6 Not remote (0.33333333 0.66666667)  
&gt;                             14700) company_size_number&gt;=60 10   5 Remote (0.50000000 0.50000000)  
&gt;                               29400) career_satisfaction&lt; 7.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                               29401) career_satisfaction&gt;=7.5 7   2 Not remote (0.28571429 0.71428571)  
&gt;                                 58802) salary&lt; 51537.3 1   0 Remote (1.00000000 0.00000000) *
&gt;                                 58803) salary&gt;=51537.3 6   1 Not remote (0.16666667 0.83333333)  
&gt;                                  117606) salary&gt;=61303.03 2   1 Remote (0.50000000 0.50000000)  
&gt;                                    235212) salary&lt; 62451.61 1   0 Remote (1.00000000 0.00000000) *
&gt;                                    235213) salary&gt;=62451.61 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                  117607) salary&lt; 61303.03 4   0 Not remote (0.00000000 1.00000000) *
&gt;                             14701) company_size_number&lt; 60 8   1 Not remote (0.12500000 0.87500000)  
&gt;                               29402) years_coded_job&gt;=13.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                               29403) years_coded_job&lt; 13.5 7   0 Not remote (0.00000000 1.00000000) *
&gt;                            7351) salary&lt; 47943.55 9   0 Not remote (0.00000000 1.00000000) *
&gt;                       919) salary&gt;=80322.58 9   1 Not remote (0.11111111 0.88888889)  
&gt;                        1838) company_size_number&lt; 60 2   1 Remote (0.50000000 0.50000000)  
&gt;                          3676) salary&lt; 84750 1   0 Remote (1.00000000 0.00000000) *
&gt;                          3677) salary&gt;=84750 1   0 Not remote (0.00000000 1.00000000) *
&gt;                        1839) company_size_number&gt;=60 7   0 Not remote (0.00000000 1.00000000) *
&gt;                 115) embedded_developer&gt;=0.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;              29) developer_with_stats_math_background&gt;=0.5 10   1 Not remote (0.10000000 0.90000000)  
&gt;                58) data_scientist&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                59) data_scientist&lt; 0.5 9   0 Not remote (0.00000000 1.00000000) *
&gt;            15) open_source&lt; 0.5 270  76 Not remote (0.28148148 0.71851852)  
&gt;              30) company_size_number&lt; 60 87  34 Not remote (0.39080460 0.60919540)  
&gt;                60) salary&lt; 9543.386 7   1 Remote (0.85714286 0.14285714)  
&gt;                 120) years_coded_job&lt; 5.5 5   0 Remote (1.00000000 0.00000000) *
&gt;                 121) years_coded_job&gt;=5.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                   242) salary&gt;=4881.72 1   0 Remote (1.00000000 0.00000000) *
&gt;                   243) salary&lt; 4881.72 1   0 Not remote (0.00000000 1.00000000) *
&gt;                61) salary&gt;=9543.386 80  28 Not remote (0.35000000 0.65000000)  
&gt;                 122) career_satisfaction&gt;=7.5 48  21 Not remote (0.43750000 0.56250000)  
&gt;                   244) salary&gt;=40806.45 36  17 Remote (0.52777778 0.47222222)  
&gt;                     488) years_coded_job&lt; 14.5 30  12 Remote (0.60000000 0.40000000)  
&gt;                       976) desktop_applications_developer&gt;=0.5 7   1 Remote (0.85714286 0.14285714)  
&gt;                        1952) years_coded_job&gt;=3.5 6   0 Remote (1.00000000 0.00000000) *
&gt;                        1953) years_coded_job&lt; 3.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       977) desktop_applications_developer&lt; 0.5 23  11 Remote (0.52173913 0.47826087)  
&gt;                        1954) salary&lt; 76500 21   9 Remote (0.57142857 0.42857143)  
&gt;                          3908) hobby&lt; 0.5 5   0 Remote (1.00000000 0.00000000) *
&gt;                          3909) hobby&gt;=0.5 16   7 Not remote (0.43750000 0.56250000)  
&gt;                            7818) years_coded_job&gt;=2.5 12   5 Remote (0.58333333 0.41666667)  
&gt;                             15636) mobile_developer&gt;=0.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                             15637) mobile_developer&lt; 0.5 9   4 Not remote (0.44444444 0.55555556)  
&gt;                               31274) years_coded_job&gt;=6.5 4   1 Remote (0.75000000 0.25000000)  
&gt;                                 62548) graphic_designer&lt; 0.5 3   0 Remote (1.00000000 0.00000000) *
&gt;                                 62549) graphic_designer&gt;=0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                               31275) years_coded_job&lt; 6.5 5   1 Not remote (0.20000000 0.80000000)  
&gt;                                 62550) data_scientist&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                                 62551) data_scientist&lt; 0.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                            7819) years_coded_job&lt; 2.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                        1955) salary&gt;=76500 2   0 Not remote (0.00000000 1.00000000) *
&gt;                     489) years_coded_job&gt;=14.5 6   1 Not remote (0.16666667 0.83333333)  
&gt;                       978) salary&gt;=81418.01 1   0 Remote (1.00000000 0.00000000) *
&gt;                       979) salary&lt; 81418.01 5   0 Not remote (0.00000000 1.00000000) *
&gt;                   245) salary&lt; 40806.45 12   2 Not remote (0.16666667 0.83333333)  
&gt;                     490) years_coded_job&gt;=17.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                     491) years_coded_job&lt; 17.5 11   1 Not remote (0.09090909 0.90909091)  
&gt;                       982) web_developer&lt; 0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                       983) web_developer&gt;=0.5 10   0 Not remote (0.00000000 1.00000000) *
&gt;                 123) career_satisfaction&lt; 7.5 32   7 Not remote (0.21875000 0.78125000)  
&gt;                   246) salary&gt;=58250 15   5 Not remote (0.33333333 0.66666667)  
&gt;                     492) years_coded_job&lt; 2.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                     493) years_coded_job&gt;=2.5 13   3 Not remote (0.23076923 0.76923077)  
&gt;                       986) dev_ops&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                       987) dev_ops&lt; 0.5 12   2 Not remote (0.16666667 0.83333333)  
&gt;                        1974) mobile_developer&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                        1975) mobile_developer&lt; 0.5 11   1 Not remote (0.09090909 0.90909091)  
&gt;                          3950) salary&lt; 64758.06 3   1 Not remote (0.33333333 0.66666667)  
&gt;                            7900) salary&gt;=61827.96 1   0 Remote (1.00000000 0.00000000) *
&gt;                            7901) salary&lt; 61827.96 2   0 Not remote (0.00000000 1.00000000) *
&gt;                          3951) salary&gt;=64758.06 8   0 Not remote (0.00000000 1.00000000) *
&gt;                   247) salary&lt; 58250 17   2 Not remote (0.11764706 0.88235294)  
&gt;                     494) salary&lt; 38104.84 5   2 Not remote (0.40000000 0.60000000)  
&gt;                       988) years_coded_job&lt; 3.5 3   1 Remote (0.66666667 0.33333333)  
&gt;                        1976) hobby&gt;=0.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                        1977) hobby&lt; 0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                       989) years_coded_job&gt;=3.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                     495) salary&gt;=38104.84 12   0 Not remote (0.00000000 1.00000000) *
&gt;              31) company_size_number&gt;=60 183  42 Not remote (0.22950820 0.77049180)  
&gt;                62) salary&gt;=74983.75 38  15 Not remote (0.39473684 0.60526316)  
&gt;                 124) career_satisfaction&lt; 7.5 15   6 Remote (0.60000000 0.40000000)  
&gt;                   248) years_coded_job&lt; 8 10   2 Remote (0.80000000 0.20000000)  
&gt;                     496) years_coded_job&gt;=2.5 6   0 Remote (1.00000000 0.00000000) *
&gt;                     497) years_coded_job&lt; 2.5 4   2 Remote (0.50000000 0.50000000)  
&gt;                       994) company_size_number&gt;=2750 2   0 Remote (1.00000000 0.00000000) *
&gt;                       995) company_size_number&lt; 2750 2   0 Not remote (0.00000000 1.00000000) *
&gt;                   249) years_coded_job&gt;=8 5   1 Not remote (0.20000000 0.80000000)  
&gt;                     498) salary&gt;=87250 2   1 Remote (0.50000000 0.50000000)  
&gt;                       996) salary&lt; 88250 1   0 Remote (1.00000000 0.00000000) *
&gt;                       997) salary&gt;=88250 1   0 Not remote (0.00000000 1.00000000) *
&gt;                     499) salary&lt; 87250 3   0 Not remote (0.00000000 1.00000000) *
&gt;                 125) career_satisfaction&gt;=7.5 23   6 Not remote (0.26086957 0.73913043)  
&gt;                   250) salary&lt; 84500 17   6 Not remote (0.35294118 0.64705882)  
&gt;                     500) years_coded_job&gt;=9.5 6   2 Remote (0.66666667 0.33333333)  
&gt;                      1000) company_size_number&lt; 5250 3   0 Remote (1.00000000 0.00000000) *
&gt;                      1001) company_size_number&gt;=5250 3   1 Not remote (0.33333333 0.66666667)  
&gt;                        2002) years_coded_job&lt; 15 1   0 Remote (1.00000000 0.00000000) *
&gt;                        2003) years_coded_job&gt;=15 2   0 Not remote (0.00000000 1.00000000) *
&gt;                     501) years_coded_job&lt; 9.5 11   2 Not remote (0.18181818 0.81818182)  
&gt;                      1002) years_coded_job&lt; 2.5 4   2 Remote (0.50000000 0.50000000)  
&gt;                        2004) salary&gt;=76500 3   1 Remote (0.66666667 0.33333333)  
&gt;                          4008) desktop_applications_developer&lt; 0.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                          4009) desktop_applications_developer&gt;=0.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                        2005) salary&lt; 76500 1   0 Not remote (0.00000000 1.00000000) *
&gt;                      1003) years_coded_job&gt;=2.5 7   0 Not remote (0.00000000 1.00000000) *
&gt;                   251) salary&gt;=84500 6   0 Not remote (0.00000000 1.00000000) *
&gt;                63) salary&lt; 74983.75 145  27 Not remote (0.18620690 0.81379310)  
&gt;                 126) data_scientist&gt;=0.5 11   4 Not remote (0.36363636 0.63636364)  
&gt;                   252) developer_with_stats_math_background&lt; 0.5 7   3 Remote (0.57142857 0.42857143)  
&gt;                     504) salary&lt; 58064.52 5   1 Remote (0.80000000 0.20000000)  
&gt;                      1008) salary&gt;=8368.815 3   0 Remote (1.00000000 0.00000000) *
&gt;                      1009) salary&lt; 8368.815 2   1 Remote (0.50000000 0.50000000)  
&gt;                        2018) salary&lt; 4698.282 1   0 Remote (1.00000000 0.00000000) *
&gt;                        2019) salary&gt;=4698.282 1   0 Not remote (0.00000000 1.00000000) *
&gt;                     505) salary&gt;=58064.52 2   0 Not remote (0.00000000 1.00000000) *
&gt;                   253) developer_with_stats_math_background&gt;=0.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                 127) data_scientist&lt; 0.5 134  23 Not remote (0.17164179 0.82835821)  
&gt;                   254) graphic_designer&gt;=0.5 2   1 Remote (0.50000000 0.50000000)  
&gt;                     508) salary&gt;=61750 1   0 Remote (1.00000000 0.00000000) *
&gt;                     509) salary&lt; 61750 1   0 Not remote (0.00000000 1.00000000) *
&gt;                   255) graphic_designer&lt; 0.5 132  22 Not remote (0.16666667 0.83333333)  
&gt;                     510) salary&lt; 62970.43 104  20 Not remote (0.19230769 0.80769231)  
&gt;                      1020) salary&gt;=53437.5 26   9 Not remote (0.34615385 0.65384615)  
&gt;                        2040) years_coded_job&gt;=1.5 22   9 Not remote (0.40909091 0.59090909)  
&gt;                          4080) mobile_developer&lt; 0.5 19   9 Not remote (0.47368421 0.52631579)  
&gt;                            8160) dev_ops&lt; 0.5 17   8 Remote (0.52941176 0.47058824)  
&gt;                             16320) salary&lt; 56125 4   0 Remote (1.00000000 0.00000000) *
&gt;                             16321) salary&gt;=56125 13   5 Not remote (0.38461538 0.61538462)  
&gt;                               32642) career_satisfaction&gt;=7.5 8   3 Remote (0.62500000 0.37500000)  
&gt;                                 65284) years_coded_job&lt; 5 3   0 Remote (1.00000000 0.00000000) *
&gt;                                 65285) years_coded_job&gt;=5 5   2 Not remote (0.40000000 0.60000000)  
&gt;                                  130570) salary&gt;=59569.89 3   1 Remote (0.66666667 0.33333333)  
&gt;                                    261140) salary&lt; 61875 2   0 Remote (1.00000000 0.00000000) *
&gt;                                    261141) salary&gt;=61875 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                  130571) salary&lt; 59569.89 2   0 Not remote (0.00000000 1.00000000) *
&gt;                               32643) career_satisfaction&lt; 7.5 5   0 Not remote (0.00000000 1.00000000) *
&gt;                            8161) dev_ops&gt;=0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                          4081) mobile_developer&gt;=0.5 3   0 Not remote (0.00000000 1.00000000) *
&gt;                        2041) years_coded_job&lt; 1.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                      1021) salary&lt; 53437.5 78  11 Not remote (0.14102564 0.85897436)  
&gt;                        2042) career_satisfaction&gt;=9.5 9   3 Not remote (0.33333333 0.66666667)  
&gt;                          4084) company_size_number&lt; 300 3   0 Remote (1.00000000 0.00000000) *
&gt;                          4085) company_size_number&gt;=300 6   0 Not remote (0.00000000 1.00000000) *
&gt;                        2043) career_satisfaction&lt; 9.5 69   8 Not remote (0.11594203 0.88405797)  
&gt;                          4086) salary&lt; 30287.5 32   6 Not remote (0.18750000 0.81250000)  
&gt;                            8172) salary&gt;=28881.05 1   0 Remote (1.00000000 0.00000000) *
&gt;                            8173) salary&lt; 28881.05 31   5 Not remote (0.16129032 0.83870968)  
&gt;                             16346) quality_assurance_engineer&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                             16347) quality_assurance_engineer&lt; 0.5 30   4 Not remote (0.13333333 0.86666667)  
&gt;                               32694) salary&gt;=9837.028 18   4 Not remote (0.22222222 0.77777778)  
&gt;                                 65388) salary&lt; 11892.53 1   0 Remote (1.00000000 0.00000000) *
&gt;                                 65389) salary&gt;=11892.53 17   3 Not remote (0.17647059 0.82352941)  
&gt;                                  130778) developer_with_stats_math_background&gt;=0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                                  130779) developer_with_stats_math_background&lt; 0.5 16   2 Not remote (0.12500000 0.87500000)  
&gt;                                    261558) career_satisfaction&gt;=7.5 6   2 Not remote (0.33333333 0.66666667)  
&gt;                                      523116) salary&gt;=14315.08 3   1 Remote (0.66666667 0.33333333)  
&gt;                                       1046232) years_coded_job&gt;=2.5 2   0 Remote (1.00000000 0.00000000) *
&gt;                                       1046233) years_coded_job&lt; 2.5 1   0 Not remote (0.00000000 1.00000000) *
&gt;                                      523117) salary&lt; 14315.08 3   0 Not remote (0.00000000 1.00000000) *
&gt;                                    261559) career_satisfaction&lt; 7.5 10   0 Not remote (0.00000000 1.00000000) *
&gt;                               32695) salary&lt; 9837.028 12   0 Not remote (0.00000000 1.00000000) *
&gt;                          4087) salary&gt;=30287.5 37   2 Not remote (0.05405405 0.94594595)  
&gt;                            8174) company_size_number&gt;=3000 13   2 Not remote (0.15384615 0.84615385)  
&gt;                             16348) company_size_number&lt; 7500 1   0 Remote (1.00000000 0.00000000) *
&gt;                             16349) company_size_number&gt;=7500 12   1 Not remote (0.08333333 0.91666667)  
&gt;                               32698) years_coded_job&lt; 2.5 3   1 Not remote (0.33333333 0.66666667)  
&gt;                                 65396) hobby&lt; 0.5 1   0 Remote (1.00000000 0.00000000) *
&gt;                                 65397) hobby&gt;=0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                               32699) years_coded_job&gt;=2.5 9   0 Not remote (0.00000000 1.00000000) *
&gt;                            8175) company_size_number&lt; 3000 24   0 Not remote (0.00000000 1.00000000) *
&gt;                     511) salary&gt;=62970.43 28   2 Not remote (0.07142857 0.92857143)  
&gt;                      1022) company_size_number&gt;=7500 9   2 Not remote (0.22222222 0.77777778)  
&gt;                        2044) years_coded_job&gt;=2.5 5   2 Not remote (0.40000000 0.60000000)  
&gt;                          4088) dev_ops&lt; 0.5 3   1 Remote (0.66666667 0.33333333)  
&gt;                            8176) salary&gt;=66875 2   0 Remote (1.00000000 0.00000000) *
&gt;                            8177) salary&lt; 66875 1   0 Not remote (0.00000000 1.00000000) *
&gt;                          4089) dev_ops&gt;=0.5 2   0 Not remote (0.00000000 1.00000000) *
&gt;                        2045) years_coded_job&lt; 2.5 4   0 Not remote (0.00000000 1.00000000) *
&gt;                      1023) company_size_number&lt; 7500 19   0 Not remote (0.00000000 1.00000000) *
```

.footnote[* see your `04-helpers.R` script]

---
class: your-turn

# Your turn 3

Let's combine bootstrapping with decision trees.

Do **Round 1** on your handouts.

<div class="countdown" id="timer_5ea1c59c" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
exclude: true





---
class: middle

# The trouble with trees?

&lt;img src="figs/04-ensemble/unnamed-chunk-26-1.png" width="33%" style="display: block; margin: auto;" /&gt;&lt;img src="figs/04-ensemble/unnamed-chunk-26-2.png" width="33%" style="display: block; margin: auto;" /&gt;&lt;img src="figs/04-ensemble/unnamed-chunk-26-3.png" width="33%" style="display: block; margin: auto;" /&gt;

---
class: your-turn

# Your turn 4

Now, let's add the aggregating part.

Do **Round 2** on your handouts.


<div class="countdown" id="timer_5ea1c4a3" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---
class: middle, center

# Your first ensemble!

&lt;img src="images/orchestra.jpg" width="25%" style="display: block; margin: auto;" /&gt;


---
background-image: url(images/ensemble/ensemble.001.jpeg)
background-size: cover

---
background-image: url(images/ensemble/ensemble.002.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.003.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.004.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.005.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.006.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.007.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.008.jpeg)
background-size: contain

---
background-image: url(images/ensemble/ensemble.009.jpeg)
background-size: contain

---
class: middle, frame, center

# Axiom

There is an inverse relationship between  
model *accuracy* and model *interpretability*.


---
class: middle, center


# `rand_forest()`

Specifies a random forest model



```r
rand_forest(mtry = 4, trees = 500, min_n = 1)
```

--

*either* mode works!

---
class: middle

.center[

# `rand_forest()`

Specifies a random forest model

]



```r
rand_forest(
  mtry = 4,    # predictors seen at each node
  trees = 500, # trees per forest
  min_n = 1    # smallest node allowed
  )
```

---
class: your-turn

# Your turn 5

Create a new model spec called `rf_spec`, which will learn an ensemble of classification trees from our training data using the **ranger** package. 

Compare the metrics of the random forest to your two single tree models (vanilla and big)- which predicts the test set better?

*Hint: you'll need https://tidymodels.github.io/parsnip/articles/articles/Models.html*

<div class="countdown" id="timer_5ea1c6f7" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

```r
rf_spec &lt;-
  rand_forest() %&gt;% 
  set_engine("ranger") %&gt;% 
  set_mode("classification")

set.seed(100)
rf_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.639    10  0.0155
&gt; 2 roc_auc  binary     0.691    10  0.0212
```

---

.pull-left[
### Vanilla Decision Tree

```
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.639    10  0.0142
&gt; 2 roc_auc  binary     0.652    10  0.0197
```


### Big Decision Tree

```
&gt; # A tibble: 2 x 3
&gt;   .metric  .estimator .estimate
&gt;   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
&gt; 1 accuracy binary         0.605
&gt; 2 roc_auc  binary         0.605
```
]

.pull-right[
### Random Forest

```
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.640    10  0.0151
&gt; 2 roc_auc  binary     0.690    10  0.0216
```
]

---
class: middle, center

`mtry` 

The number of predictors that will be randomly sampled at each split when creating the tree models.


```r
rand_forest(mtry = 4)
```

**ranger** default = `floor(sqrt(num_predictors))`

---
class: your-turn

# Your turn 6

Challenge: Make 4 more random forest model specs, each using 4, 8, 12, and 20 variables at each split. Which value maximizes the area under the ROC curve?

*Hint: you'll need https://tidymodels.github.io/parsnip/reference/rand_forest.html*

<div class="countdown" id="timer_5ea1c79c" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">04</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---

```r
rf4_spec &lt;- rf_spec %&gt;% 
* set_args(mtry = 4)

set.seed(100)
rf4_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.639    10  0.0155
&gt; 2 roc_auc  binary     0.691    10  0.0212
```

---

```r
rf8_spec &lt;- rf_spec %&gt;% 
* set_args(mtry = 8)

set.seed(100)
rf8_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.641    10  0.0169
&gt; 2 roc_auc  binary     0.678    10  0.0225
```

---

```r
rf12_spec &lt;- rf_spec %&gt;% 
* set_args(mtry = 12)

set.seed(100)
rf12_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.633    10  0.0171
&gt; 2 roc_auc  binary     0.667    10  0.0234
```

---

```r
rf20_spec &lt;- rf_spec %&gt;% 
* set_args(mtry = 19)

set.seed(100)
rf20_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.625    10  0.0159
&gt; 2 roc_auc  binary     0.662    10  0.0221
```

---
class: middle, center



&lt;img src="figs/04-ensemble/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;" /&gt;



---

```r
treebag_spec &lt;-
* rand_forest(mtry = .preds()) %&gt;%
  set_engine("ranger") %&gt;% 
  set_mode("classification")

set.seed(100)
treebag_spec %&gt;% 
  fit_resamples(remote ~ ., 
                resamples = so_folds) %&gt;% 
  collect_metrics()
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.625    10  0.0159
&gt; 2 roc_auc  binary     0.662    10  0.0221
```


---
class: center, middle

# `.preds()`

The number of columns in the data set that are associated with the predictors prior to dummy variable creation.


```r
rand_forest(mtry = .preds())
```

--

&lt;https://tidymodels.github.io/parsnip/reference/descriptors.html&gt;

---

.pull-left[
### Vanilla Decision Tree


```
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.639    10  0.0142
&gt; 2 roc_auc  binary     0.652    10  0.0197
```


### Big Decision Tree

```
&gt; # A tibble: 2 x 3
&gt;   .metric  .estimator .estimate
&gt;   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
&gt; 1 accuracy binary         0.605
&gt; 2 roc_auc  binary         0.605
```
]

.pull-right[
### Random Forest

```
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.640    10  0.0151
&gt; 2 roc_auc  binary     0.690    10  0.0216
```

### Bagging

```
&gt; # A tibble: 2 x 5
&gt;   .metric  .estimator  mean     n std_err
&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1 accuracy binary     0.630    10  0.0135
&gt; 2 roc_auc  binary     0.663    10  0.0231
```
]

---
class: middle, frame

# .center[To specify a model with parsnip]

.right-column[

.fade[

1\. Pick a .display[model]

]

2\. Set the .display[engine]

.fade[

3\. Set the .display[mode] (if needed)
]
]

---
class: middle, center


# `set_engine()`

Adds to a model an R package to train the model.


```r
spec %&gt;% set_engine(engine = "ranger", ...)
```


---
class: middle

.center[

# `set_engine()`

Adds to a model an R package to train the model.

]



```r
spec %&gt;% 
  set_engine(
    engine = "ranger", # package name in quotes
    ...                # optional arguments to pass to function
    )
```

---
class: middle

.center[
.fade[

# `set_engine()`

Adds to a model an R package to train the model.
]
]


```r
rf_imp_spec &lt;-
  rand_forest(mtry = 4) %&gt;% 
  set_engine("ranger", importance = 'impurity') %&gt;% 
  set_mode("classification")
```

---



```r
rf_imp_spec &lt;-
  rand_forest(mtry = 4) %&gt;% 
  set_engine("ranger", importance = 'impurity') %&gt;% 
  set_mode("classification")

imp_fit &lt;- 
  rf_imp_spec %&gt;% 
  last_fit(remote ~ .,
           split = so_split) 

imp_fit
&gt; # Monte Carlo cross-validation (0.75/0.25) with 1 resamples  
&gt; # A tibble: 1 x 6
&gt;   splits   id      .metrics   .notes  .predictions .workflow
&gt;   &lt;list&gt;   &lt;chr&gt;   &lt;list&gt;     &lt;list&gt;  &lt;list&gt;       &lt;list&gt;   
&gt; 1 &lt;split ‚Ä¶ train/‚Ä¶ &lt;tibble [‚Ä¶ &lt;tibbl‚Ä¶ &lt;tibble [28‚Ä¶ &lt;workflo‚Ä¶
```

---
class: middle

.center[

# `get_tree_fit()`

Gets the parsnip model object from the output of `fit_split()`

]


```r
get_tree_fit(imp_fit)
```


.footnote[in your helpers.R script]

---

```r
get_tree_fit(imp_fit)
&gt; parsnip model object
&gt; 
&gt; Fit time:  299ms 
&gt; Ranger result
&gt; 
&gt; Call:
&gt;  ranger::ranger(formula = formula, data = data, mtry = ~4, importance = ~"impurity",      num.threads = 1, verbose = FALSE, seed = sample.int(10^5,          1), probability = TRUE) 
&gt; 
&gt; Type:                             Probability estimation 
&gt; Number of trees:                  500 
&gt; Sample size:                      864 
&gt; Number of independent variables:  19 
&gt; Mtry:                             4 
&gt; Target node size:                 10 
&gt; Variable importance mode:         impurity 
&gt; Splitrule:                        gini 
&gt; OOB prediction error (Brier s.):  0.2224028
```

---
class: middle, center

# `vip`

Plot variable importance.

&lt;iframe src="https://koalaverse.github.io/vip/index.html" width="504" height="400px"&gt;&lt;/iframe&gt;

---
class: middle, center

# `vip()`

Plot variable importance scores for the predictors in a model. 


```r
vip(object, geom = "point", ...)
```

---
class: middle

.center[

# `vip()`

Plot variable importance scores for the predictors in a model. 

]


```r
vip(
  object,       # fitted model object
  geom = "col", # one of "col", "point", "boxplot", "violin"
  ...
  )
```

---


```r
imp_plot &lt;- get_tree_fit(imp_fit)
vip::vip(imp_plot, geom = "point")
```

&lt;img src="figs/04-ensemble/unnamed-chunk-59-1.png" width="504" style="display: block; margin: auto;" /&gt;


---
class: your-turn

# Your turn 7

Make a new model spec called `treebag_imp_spec` to fit a bagged classification tree model. Set the variable `importance` mode to "permutation". Plot the variable importance- which variable was the most important?

<div class="countdown" id="timer_5ea1c5f4" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---
class: middle

```r
treebag_imp_spec &lt;-
  rand_forest(mtry = .preds()) %&gt;% 
  set_engine("ranger", importance = 'permutation') %&gt;% 
  set_mode("classification")

treebag_wf &lt;-
  workflow() %&gt;% 
  add_formula(remote ~ .) %&gt;% 
  add_model(treebag_imp_spec)

imp_fit &lt;- 
  treebag_wf %&gt;% 
  last_fit(split = so_split)

imp_plot &lt;- get_tree_fit(imp_fit)
```

---





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLanguage": "r",
"highlightStyle": "xcode",
"slideNumberFormat": "",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
